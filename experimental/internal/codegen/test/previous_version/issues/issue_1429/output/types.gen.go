// Code generated by oapi-codegen; DO NOT EDIT.

package output

import (
	"bytes"
	"compress/gzip"
	"encoding/base64"
	"encoding/json"
	"fmt"
	"strings"
	"sync"
)

// #/components/schemas/test
type Test struct {
	TestAnyOf0 *TestAnyOf0
	TestAnyOf1 *TestAnyOf1
}

func (u Test) MarshalJSON() ([]byte, error) {
	result := make(map[string]any)

	if u.TestAnyOf0 != nil {
		data, err := json.Marshal(u.TestAnyOf0)
		if err != nil {
			return nil, err
		}
		var m map[string]any
		if err := json.Unmarshal(data, &m); err == nil {
			for k, v := range m {
				result[k] = v
			}
		}
	}
	if u.TestAnyOf1 != nil {
		data, err := json.Marshal(u.TestAnyOf1)
		if err != nil {
			return nil, err
		}
		var m map[string]any
		if err := json.Unmarshal(data, &m); err == nil {
			for k, v := range m {
				result[k] = v
			}
		}
	}

	return json.Marshal(result)
}

func (u *Test) UnmarshalJSON(data []byte) error {
	var v0 TestAnyOf0
	if err := json.Unmarshal(data, &v0); err == nil {
		u.TestAnyOf0 = &v0
	}

	var v1 TestAnyOf1
	if err := json.Unmarshal(data, &v1); err == nil {
		u.TestAnyOf1 = &v1
	}

	return nil
}

// ApplyDefaults sets default values for fields that are nil.
func (u *Test) ApplyDefaults() {
	if u.TestAnyOf0 != nil {
		u.TestAnyOf0.ApplyDefaults()
	}
	if u.TestAnyOf1 != nil {
		u.TestAnyOf1.ApplyDefaults()
	}
}

// #/components/schemas/test/anyOf/0
type TestAnyOf0 struct {
	FieldA *string `json:"fieldA,omitempty" form:"fieldA,omitempty"`
}

// ApplyDefaults sets default values for fields that are nil.
func (s *TestAnyOf0) ApplyDefaults() {
}

// #/components/schemas/test/anyOf/1
type TestAnyOf1 struct {
	FieldA *string `json:"fieldA,omitempty" form:"fieldA,omitempty"`
}

// ApplyDefaults sets default values for fields that are nil.
func (s *TestAnyOf1) ApplyDefaults() {
}

// #/components/schemas/test/anyOf/1/properties/fieldA
type TestAnyOf1FieldA string

const (
	Foo TestAnyOf1FieldA = "foo"
	Bar TestAnyOf1FieldA = "bar"
)

// Base64-encoded, gzip-compressed OpenAPI spec.
var openAPISpecJSON = []string{
	"H4sIAAAAAAAC/6xSsW7cMAzd9RUPcYEsvfMl7VJtHTN1KdBZtmlLwZkURLrF/X0hOwdfrh3DiXqkHt8T",
	"1eBFdSE8fX3+5kG8zGAxTMRUgtGAP5EYi9YsWUTgy4/RNYhmWX3bTsni0h17mVsJOR16GWgifn9IdYS2",
	"dYZrXINflTMgF8lU7ILEmgZC4I0eM80dFcSgFauiPsMibfLsksk10CjLeUBHu9ajk0wccvL4cjwdTy7x",
	"KN4BluxM/sYpfpKaA35T0STs8bT252BR64XWSK0mwERvCVDVBkvCL4O/MtQopFlYSa+NwMPz6fSwH4Fe",
	"2IjtFgJCzufUr5Ttqwq/rwLaR5rDPQp8KjR6PDZtL3MWJjZtt15dlT+6vVBvv9U2ot0a1rf0kO6V+quZ",
	"dQP7yMN1S+nWXo0x0Xn4fi9uY1QriaePJdmifoF/H+SAUeQ/aBeK+xsAAP//dJpKJ+ICAAA=",
}

// decodeOpenAPISpec decodes and decompresses the embedded spec.
func decodeOpenAPISpec() ([]byte, error) {
	joined := strings.Join(openAPISpecJSON, "")
	raw, err := base64.StdEncoding.DecodeString(joined)
	if err != nil {
		return nil, fmt.Errorf("decoding base64: %w", err)
	}
	r, err := gzip.NewReader(bytes.NewReader(raw))
	if err != nil {
		return nil, fmt.Errorf("creating gzip reader: %w", err)
	}
	defer r.Close()
	var out bytes.Buffer
	if _, err := out.ReadFrom(r); err != nil {
		return nil, fmt.Errorf("decompressing: %w", err)
	}
	return out.Bytes(), nil
}

// decodeOpenAPISpecCached returns a closure that caches the decoded spec.
func decodeOpenAPISpecCached() func() ([]byte, error) {
	var cached []byte
	var cachedErr error
	var once sync.Once
	return func() ([]byte, error) {
		once.Do(func() {
			cached, cachedErr = decodeOpenAPISpec()
		})
		return cached, cachedErr
	}
}

var openAPISpec = decodeOpenAPISpecCached()

// GetOpenAPISpecJSON returns the raw OpenAPI spec as JSON bytes.
func GetOpenAPISpecJSON() ([]byte, error) {
	return openAPISpec()
}
