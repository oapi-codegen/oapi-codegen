// Code generated by oapi-codegen; DO NOT EDIT.

package spec_base

import (
	"bytes"
	"compress/gzip"
	"encoding/base64"
	"fmt"
	"reflect"
	"strings"
	"sync"

	ext_01f5765b "github.com/oapi-codegen/oapi-codegen-exp/experimental/internal/codegen/test/previous_version/issues/issue_removed_external_ref/output/spec_ext"
)

// #/components/schemas/DirectBar
type DirectBar = ext_01f5765b.Foo

// #/components/schemas/PackedBar
type PackedBar struct {
	ID      *string           `json:"id,omitempty" form:"id,omitempty"`
	Core    *ext_01f5765b.Foo `json:"core,omitempty" form:"core,omitempty"`
	Directd *DirectBar        `json:"directd,omitempty" form:"directd,omitempty"`
}

// ApplyDefaults sets default values for fields that are nil.
func (s *PackedBar) ApplyDefaults() {
	if s.Core != nil {
		if m := reflect.ValueOf(s.Core).MethodByName("ApplyDefaults"); m.IsValid() {
			m.Call(nil)
		}
	}
}

// #/paths//noTrouble/post/responses/200/content/application/json/schema
type PostNoTrouble200Response struct {
	DirectFoo   *ext_01f5765b.Foo `json:"directFoo,omitempty" form:"directFoo,omitempty"`
	DirectBar   *DirectBar        `json:"directBar,omitempty" form:"directBar,omitempty"`
	IndirectFoo *PackedBar        `json:"indirectFoo,omitempty" form:"indirectFoo,omitempty"`
	Name        *string           `json:"name,omitempty" form:"name,omitempty"`
}

// ApplyDefaults sets default values for fields that are nil.
func (s *PostNoTrouble200Response) ApplyDefaults() {
	if s.DirectFoo != nil {
		if m := reflect.ValueOf(s.DirectFoo).MethodByName("ApplyDefaults"); m.IsValid() {
			m.Call(nil)
		}
	}
	if s.IndirectFoo != nil {
		s.IndirectFoo.ApplyDefaults()
	}
}

// Base64-encoded, gzip-compressed OpenAPI spec.
var openAPISpecJSON = []string{
	"H4sIAAAAAAAC/5SSQVPCMBCF7/0VO9WraYVbjw5ydhz/QEgXCba7O9nIwL93ai0UDGJvTV76zdu3jwXJ",
	"iq9gbkozyzytucoAdhjUM1WQl6Y0j3kmNm60Uwrit8Cfqwa7E4Cwxv4LIKAKk6IOFwCzsjwdAGpUF7zE",
	"b7YxZiQ5pogUx68BrEjjne3eF1tlOlcB1G2wtZe3APEgWAGvtujiL1ECC4boxz5HFn1AF5fMKRHgPuC6",
	"glwF3QPuoznYtrkrHLfChBS16C1psWTOr+KfbPgTnyQuhl9TXE//M54kv1j3gfUVMtkW08g+ZY3B03tX",
	"DU872/j6eR9fcT2lJfPzltzM+IgoxKqzTZ5lJ7Uj/QzWQxeXkU/f4TGgAZEoWKpWvh7PdZHX0PuAk4ZP",
	"Fqxffp0A3arSVwAAAP//8S98fAIEAAA=",
}

// decodeOpenAPISpec decodes and decompresses the embedded spec.
func decodeOpenAPISpec() ([]byte, error) {
	joined := strings.Join(openAPISpecJSON, "")
	raw, err := base64.StdEncoding.DecodeString(joined)
	if err != nil {
		return nil, fmt.Errorf("decoding base64: %w", err)
	}
	r, err := gzip.NewReader(bytes.NewReader(raw))
	if err != nil {
		return nil, fmt.Errorf("creating gzip reader: %w", err)
	}
	defer r.Close()
	var out bytes.Buffer
	if _, err := out.ReadFrom(r); err != nil {
		return nil, fmt.Errorf("decompressing: %w", err)
	}
	return out.Bytes(), nil
}

// decodeOpenAPISpecCached returns a closure that caches the decoded spec.
func decodeOpenAPISpecCached() func() ([]byte, error) {
	var cached []byte
	var cachedErr error
	var once sync.Once
	return func() ([]byte, error) {
		once.Do(func() {
			cached, cachedErr = decodeOpenAPISpec()
		})
		return cached, cachedErr
	}
}

var openAPISpec = decodeOpenAPISpecCached()

// GetOpenAPISpecJSON returns the raw OpenAPI spec as JSON bytes.
func GetOpenAPISpecJSON() ([]byte, error) {
	return openAPISpec()
}
