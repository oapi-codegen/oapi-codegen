openapi: "3.1.0"
info:
  title: Comprehensive Test Schema
  version: "1.0.0"
  description: Tests all schema patterns for oapi-codegen

paths:
  /simple:
    get:
      operationId: getSimple
      responses:
        "200":
          description: Simple response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SimpleObject"

  /inline-response:
    get:
      operationId: getInlineResponse
      responses:
        "200":
          description: Inline object in response
          content:
            application/json:
              schema:
                type: object
                required:
                  - id
                  - name
                properties:
                  id:
                    type: integer
                  name:
                    type: string

  /parameters/{pathParam}:
    parameters:
      - name: pathParam
        in: path
        required: true
        schema:
          type: string
          format: uuid
    get:
      operationId: getWithParameters
      parameters:
        - name: queryString
          in: query
          schema:
            type: string
        - name: queryInt
          in: query
          schema:
            type: integer
        - name: queryArray
          in: query
          schema:
            type: array
            items:
              type: string
        - name: headerParam
          in: header
          schema:
            type: string
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SimpleObject"

  /request-body:
    post:
      operationId: postRequestBody
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AllTypesRequired"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SimpleObject"

  /multi-content:
    post:
      operationId: postMultiContent
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/SimpleObject"
          application/x-www-form-urlencoded:
            schema:
              $ref: "#/components/schemas/SimpleObject"
          multipart/form-data:
            schema:
              type: object
              properties:
                file:
                  type: string
                  format: binary
                metadata:
                  type: string
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SimpleObject"
            text/plain:
              schema:
                type: string

components:
  schemas:
    # ===========================================
    # PRIMITIVE TYPES - All formats
    # ===========================================

    AllTypesRequired:
      type: object
      required:
        - intField
        - int32Field
        - int64Field
        - floatField
        - doubleField
        - numberField
        - stringField
        - boolField
        - dateField
        - dateTimeField
        - uuidField
        - emailField
        - uriField
        - hostnameField
        - ipv4Field
        - ipv6Field
        - byteField
        - binaryField
        - passwordField
      properties:
        intField:
          type: integer
        int32Field:
          type: integer
          format: int32
        int64Field:
          type: integer
          format: int64
        floatField:
          type: number
          format: float
        doubleField:
          type: number
          format: double
        numberField:
          type: number
        stringField:
          type: string
        boolField:
          type: boolean
        dateField:
          type: string
          format: date
        dateTimeField:
          type: string
          format: date-time
        uuidField:
          type: string
          format: uuid
        emailField:
          type: string
          format: email
        uriField:
          type: string
          format: uri
        hostnameField:
          type: string
          format: hostname
        ipv4Field:
          type: string
          format: ipv4
        ipv6Field:
          type: string
          format: ipv6
        byteField:
          type: string
          format: byte
        binaryField:
          type: string
          format: binary
        passwordField:
          type: string
          format: password

    AllTypesOptional:
      type: object
      properties:
        intField:
          type: integer
        int32Field:
          type: integer
          format: int32
        int64Field:
          type: integer
          format: int64
        floatField:
          type: number
          format: float
        doubleField:
          type: number
          format: double
        numberField:
          type: number
        stringField:
          type: string
        boolField:
          type: boolean
        dateField:
          type: string
          format: date
        dateTimeField:
          type: string
          format: date-time
        uuidField:
          type: string
          format: uuid
        emailField:
          type: string
          format: email

    # ===========================================
    # NULLABLE TYPES
    # ===========================================

    NullableRequired:
      type: object
      required:
        - nullableString
        - nullableInt
        - nullableObject
      properties:
        nullableString:
          type:
            - string
            - "null"
        nullableInt:
          type:
            - integer
            - "null"
        nullableObject:
          type:
            - object
            - "null"
          properties:
            name:
              type: string

    NullableOptional:
      type: object
      properties:
        nullableString:
          type:
            - string
            - "null"
        nullableInt:
          type:
            - integer
            - "null"

    # ===========================================
    # ARRAYS
    # ===========================================

    ArrayTypes:
      type: object
      properties:
        stringArray:
          type: array
          items:
            type: string
        intArray:
          type: array
          items:
            type: integer
        objectArray:
          type: array
          items:
            $ref: "#/components/schemas/SimpleObject"
        inlineObjectArray:
          type: array
          items:
            type: object
            properties:
              id:
                type: integer
              name:
                type: string
        nestedArray:
          type: array
          items:
            type: array
            items:
              type: string
        nullableArray:
          type:
            - array
            - "null"
          items:
            type: string
        arrayWithConstraints:
          type: array
          minItems: 1
          maxItems: 10
          items:
            type: string

    # ===========================================
    # OBJECTS
    # ===========================================

    SimpleObject:
      type: object
      required:
        - id
      properties:
        id:
          type: integer
        name:
          type: string

    NestedObject:
      type: object
      properties:
        outer:
          type: object
          properties:
            inner:
              type: object
              properties:
                value:
                  type: string

    # ===========================================
    # ADDITIONAL PROPERTIES
    # ===========================================

    AdditionalPropsAny:
      type: object
      additionalProperties: true

    AdditionalPropsNone:
      type: object
      additionalProperties: false
      properties:
        known:
          type: string

    AdditionalPropsTyped:
      type: object
      additionalProperties:
        type: integer

    AdditionalPropsObject:
      type: object
      additionalProperties:
        $ref: "#/components/schemas/SimpleObject"

    AdditionalPropsWithProps:
      type: object
      properties:
        id:
          type: integer
      additionalProperties:
        type: string

    # ===========================================
    # ENUMS
    # ===========================================

    StringEnum:
      type: string
      enum:
        - value1
        - value2
        - value3

    IntegerEnum:
      type: integer
      enum:
        - 1
        - 2
        - 3

    ObjectWithEnum:
      type: object
      properties:
        status:
          type: string
          enum:
            - pending
            - active
            - completed
        priority:
          type: integer
          enum:
            - 1
            - 2
            - 3

    InlineEnumInProperty:
      type: object
      properties:
        inlineStatus:
          type: string
          enum:
            - on
            - off

    # ===========================================
    # ALLOF - Inheritance/Composition
    # ===========================================

    BaseProperties:
      type: object
      properties:
        id:
          type: integer
        createdAt:
          type: string
          format: date-time

    ExtendedObject:
      allOf:
        - $ref: "#/components/schemas/BaseProperties"
        - type: object
          required:
            - name
          properties:
            name:
              type: string
            description:
              type: string

    DeepInheritance:
      allOf:
        - $ref: "#/components/schemas/ExtendedObject"
        - type: object
          properties:
            extra:
              type: string

    AllOfMultipleRefs:
      allOf:
        - $ref: "#/components/schemas/BaseProperties"
        - $ref: "#/components/schemas/SimpleObject"
        - type: object
          properties:
            merged:
              type: boolean

    AllOfInlineOnly:
      allOf:
        - type: object
          properties:
            first:
              type: string
        - type: object
          properties:
            second:
              type: integer

    # ===========================================
    # ANYOF - Union Types
    # ===========================================

    AnyOfPrimitives:
      anyOf:
        - type: string
        - type: integer

    AnyOfObjects:
      anyOf:
        - $ref: "#/components/schemas/SimpleObject"
        - $ref: "#/components/schemas/BaseProperties"

    AnyOfMixed:
      anyOf:
        - type: string
        - $ref: "#/components/schemas/SimpleObject"
        - type: object
          properties:
            inline:
              type: boolean

    AnyOfNullable:
      anyOf:
        - type: string
        - type: "null"

    ObjectWithAnyOfProperty:
      type: object
      properties:
        value:
          anyOf:
            - type: string
            - type: integer
            - type: boolean

    ArrayOfAnyOf:
      type: array
      items:
        anyOf:
          - $ref: "#/components/schemas/SimpleObject"
          - $ref: "#/components/schemas/BaseProperties"

    # ===========================================
    # ONEOF - Discriminated Unions
    # ===========================================

    OneOfSimple:
      oneOf:
        - $ref: "#/components/schemas/SimpleObject"
        - $ref: "#/components/schemas/BaseProperties"

    OneOfWithDiscriminator:
      oneOf:
        - $ref: "#/components/schemas/Cat"
        - $ref: "#/components/schemas/Dog"
      discriminator:
        propertyName: petType

    OneOfWithDiscriminatorMapping:
      oneOf:
        - $ref: "#/components/schemas/Cat"
        - $ref: "#/components/schemas/Dog"
      discriminator:
        propertyName: petType
        mapping:
          cat: "#/components/schemas/Cat"
          dog: "#/components/schemas/Dog"

    Cat:
      type: object
      required:
        - petType
        - meow
      properties:
        petType:
          type: string
        meow:
          type: string
        whiskerLength:
          type: number

    Dog:
      type: object
      required:
        - petType
        - bark
      properties:
        petType:
          type: string
        bark:
          type: string
        tailLength:
          type: number

    OneOfInline:
      oneOf:
        - type: object
          properties:
            optionA:
              type: string
        - type: object
          properties:
            optionB:
              type: integer

    OneOfPrimitives:
      oneOf:
        - type: string
        - type: number
        - type: boolean

    ObjectWithOneOfProperty:
      type: object
      properties:
        id:
          type: integer
        variant:
          oneOf:
            - $ref: "#/components/schemas/Cat"
            - $ref: "#/components/schemas/Dog"
          discriminator:
            propertyName: petType

    # ===========================================
    # COMBINED COMPOSITION
    # ===========================================

    AllOfWithOneOf:
      allOf:
        - $ref: "#/components/schemas/BaseProperties"
        - oneOf:
            - $ref: "#/components/schemas/Cat"
            - $ref: "#/components/schemas/Dog"
          discriminator:
            propertyName: petType

    OneOfWithAllOf:
      oneOf:
        - allOf:
            - $ref: "#/components/schemas/BaseProperties"
            - type: object
              properties:
                variant:
                  type: string
                  const: "a"
        - allOf:
            - $ref: "#/components/schemas/BaseProperties"
            - type: object
              properties:
                variant:
                  type: string
                  const: "b"

    # ===========================================
    # RECURSIVE TYPES
    # ===========================================

    TreeNode:
      type: object
      properties:
        value:
          type: string
        children:
          type: array
          items:
            $ref: "#/components/schemas/TreeNode"

    LinkedListNode:
      type: object
      properties:
        value:
          type: integer
        next:
          $ref: "#/components/schemas/LinkedListNode"

    RecursiveOneOf:
      oneOf:
        - type: string
        - type: object
          properties:
            nested:
              $ref: "#/components/schemas/RecursiveOneOf"

    # ===========================================
    # READ/WRITE ONLY
    # ===========================================

    ReadWriteOnly:
      type: object
      required:
        - id
        - password
      properties:
        id:
          type: integer
          readOnly: true
        password:
          type: string
          writeOnly: true
        name:
          type: string

    # ===========================================
    # DEFAULTS AND CONST
    # ===========================================

    WithDefaults:
      type: object
      properties:
        stringWithDefault:
          type: string
          default: "default_value"
        intWithDefault:
          type: integer
          default: 42
        boolWithDefault:
          type: boolean
          default: true
        arrayWithDefault:
          type: array
          items:
            type: string
          default: []

    WithConst:
      type: object
      properties:
        version:
          type: string
          const: "1.0.0"
        type:
          type: string
          const: "fixed"

    # ===========================================
    # CONSTRAINTS
    # ===========================================

    WithConstraints:
      type: object
      properties:
        boundedInt:
          type: integer
          minimum: 0
          maximum: 100
        exclusiveBoundedInt:
          type: integer
          exclusiveMinimum: 0
          exclusiveMaximum: 100
        multipleOf:
          type: integer
          multipleOf: 5
        boundedString:
          type: string
          minLength: 1
          maxLength: 255
        patternString:
          type: string
          pattern: "^[a-z]+$"
        boundedArray:
          type: array
          minItems: 1
          maxItems: 10
          items:
            type: string
        uniqueArray:
          type: array
          uniqueItems: true
          items:
            type: string

    # ===========================================
    # OPENAPI 3.1 SPECIFIC
    # ===========================================

    TypeArray31:
      type:
        - object
        - "null"
      properties:
        name:
          type: string

    PrefixItems31:
      type: array
      prefixItems:
        - type: string
        - type: integer
        - type: boolean
      items:
        type: string

    # ===========================================
    # EMPTY / ANY TYPE
    # ===========================================

    EmptySchema: {}

    AnyValue:
      description: Accepts any JSON value

    ExplicitAny:
      type:
        - string
        - number
        - integer
        - boolean
        - array
        - object
        - "null"

    # ===========================================
    # COMPLEX NESTED STRUCTURES
    # ===========================================

    ComplexNested:
      type: object
      properties:
        metadata:
          type: object
          additionalProperties:
            anyOf:
              - type: string
              - type: integer
              - type: array
                items:
                  type: string
        items:
          type: array
          items:
            allOf:
              - $ref: "#/components/schemas/BaseProperties"
              - type: object
                properties:
                  tags:
                    type: array
                    items:
                      type: string
        config:
          oneOf:
            - type: object
              properties:
                mode:
                  type: string
                  const: "simple"
                value:
                  type: string
            - type: object
              properties:
                mode:
                  type: string
                  const: "advanced"
                options:
                  type: object
                  additionalProperties:
                    type: string

    # ===========================================
    # MAPS
    # ===========================================

    StringMap:
      type: object
      additionalProperties:
        type: string

    ObjectMap:
      type: object
      additionalProperties:
        $ref: "#/components/schemas/SimpleObject"

    NestedMap:
      type: object
      additionalProperties:
        type: object
        additionalProperties:
          type: string
